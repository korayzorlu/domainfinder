{% extends 'layout.html' %}

{% block body %}

<div class="content">
    <div class="title" style="text-align: center;">
        <h2>INFINITUM</h2>
        <h3>CASE STUDY</h3>
        <h4>{{ request.build_absolute_uri }}</h4>
    </div>
    <div class="box">
        <div class="buttonBox">
            <button class="addButton" id="addRow">
                <i class="fas fa-solid fa-plus" style="color: #fff;"></i>
                Domain Ekle
            </button>
            <button class="removeButton" id="allRemove">
                <i class="fas fa-trash" style="color: #fff;"></i>
                Seçili Adresleri Sil
            </button>
        </div>
        <div class="tableBox">
            <table class="table" id="dataTable">
                <thead>
                    <tr>
                        <th>
                            <input type="checkbox" id="checkAllProducts" onclick="">
                        </th>
                        <th class="articleIdTh">ID</th>
                        <th>Domain Adı</th>
                        <th>Subdomain</th>
                        <th>Eklenme Tarihi</th>
                    </tr>
                </thead>
                <tbody>
                    {% for domain in domains%}
                    <tr class="odd">
                        <td class="select-checkbox"></td>
                        <td class="articleIdTd">{{ domain.id }}</td>
                        <td>{{ domain.name }}</td>
                        <td>
                            <button class="subList" id="subList"
                                onclick="subFunction('{{ domain.name }}', '{{ request.get_host}}')">
                                <i class="fas fa-solid fa-list" style="color: #fff;"></i>
                                Subdomain Listesi
                            </button>
                        </td>
                        <td>{{ domain.created_date }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="selectorBox">
            <span id="tableRowNumber"></span>
        </div>
    </div>
</div>

<script>
    function subFunction(dom, host) {
        //var myObject = {'username': 'admin', 'password': 'administration'};
        //$.getJSON('http://' + host + 'restapi/domains/?name=google.com', myObject, function(data) {});
        $.ajax({
            type: "GET",
            url: "http://" + host + "/restapi/domains/?type=json&name=" + dom,
            data: { get_param: 'value' },
            dataType: 'json',
            success: function (data) { 
                Swal.fire({html:data["results"][0]["subdomains"]})
            },
            error: function(error){
                console.log("Error:");
                console.log(error);
            }
        });
        //Swal.fire({html:dom})
    };
    
</script>

{% endblock  %}